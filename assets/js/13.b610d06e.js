(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{214:function(t,e,s){"use strict";s.r(e);var a=s(0),r=Object(a.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("div",{staticClass:"warning custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),s("p",[t._v("以下操作通常都不适用于已经push到远程的commit（除了revert）")])]),t._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("进行危险操作时:"),s("br"),t._v("\n1.最好确保工作区是clean的"),s("br"),t._v("\n2.checkout到一个新分支进行操作")])]),t._v(" "),s("p",[t._v("工作中，git rebase出现冲突，合并冲突即可解决。但有时git rebase异常，出现删文件或者commit消失的情况，此时rebase已经成功，所以需要撤销这次rebase，于是在此记录。")]),t._v(" "),s("h2",{attrs:{id:"撤销历史操作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#撤销历史操作","aria-hidden":"true"}},[t._v("#")]),t._v(" 撤销历史操作")]),t._v(" "),s("h3",{attrs:{id:"git-reflog"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#git-reflog","aria-hidden":"true"}},[t._v("#")]),t._v(" git reflog")]),t._v(" "),s("div",{staticClass:"warning custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),s("p",[t._v("这个方法针对的是个人操作，每个人的reflog都不一样，所以只能用来查最近的的还存在个人reflog中的提交。")])]),t._v(" "),s("blockquote",[s("p",[t._v("当你在工作时，Git 会在后台保存一个引用日志(reflog)，引用日志记录了一些最近你的 HEAD 和分支引用所指向的历史。")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("a005f07e "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HEAD -"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" origin-head"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" HEAD@"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(": reset: moving to a005f07e\n53ec2acc HEAD@"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(": reset: moving to 53ec2acc\n53ec2acc HEAD@"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(": reset: moving to HEAD@"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nb8c44a72 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mobile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" HEAD@"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(": checkout: moving from mobile to origin-head\nb8c44a72 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mobile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" HEAD@"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(": rebase finished: returning to refs/heads/mobile\nb8c44a72 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mobile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" HEAD@"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(": rebase: *1248 fix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mobile/alarm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" HACK - ios 微信6.7.4最新版内置浏览\n器键盘弹出再收起 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(".页面上滑不能恢复原样 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(".点击区域错位\n011bd620 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("origin/upgrade-dev"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" HEAD@"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(": rebase: checkout remotes/origin/upgrade-dev\n")])])]),s("h3",{attrs:{id:"git-reset"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#git-reset","aria-hidden":"true"}},[t._v("#")]),t._v(" git reset")]),t._v(" "),s("p",[s("router-link",{attrs:{to:"/pro-git/7.7 reset checkout.html#git-reset"}},[t._v("见git reset")])],1),t._v(" "),s("h3",{attrs:{id:"操作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#操作","aria-hidden":"true"}},[t._v("#")]),t._v(" 操作")]),t._v(" "),s("p",[t._v("git的操作，如reset, merge, rebase, commit都会记录在reflog中，所以只要使用"),s("code",[t._v("git reflog")]),t._v("找出要恢复到的那次操作，如"),s("code",[t._v("HEAD@{10}")]),t._v("，然后使用"),s("code",[t._v("git reset --hard HEAD@{10}")]),t._v("即可恢复到那次操作。不论你前一次操作是"),s("code",[t._v("git reset --hard <commit>")]),t._v("或者是"),s("code",[t._v("git rebase master dev")])]),t._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("一般我们会在错误操作后立即恢复，所以此时HEAD@{1}为上一次操作记录，直接使用以下命令也可\n"),s("code",[t._v("ORIG_HEAD")]),t._v("代表git记录的最近一次危险操作，所以包含的情况时reflog的子集，比如不包含commit\n"),s("code",[t._v("git reset --hard HEAD@{1}")]),t._v("或者"),s("code",[t._v("git reset --hard ORIG_HEAD")])])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("// --soft将HEAD指针移至指定commit，指定commit之后的修改会放在暂存区中\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" reset --soft "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("commit"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n// 除了--soft之外，指定commit之后的修改会放在工作区中\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" reset --mixied "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("commit"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n// 除了--mixied之外，指定commit之后的修改会直接丢弃掉\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" reset --hard "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("commit"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),s("h2",{attrs:{id:"修改上一次提交"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#修改上一次提交","aria-hidden":"true"}},[t._v("#")]),t._v(" 修改上一次提交")]),t._v(" "),s("p",[s("code",[t._v("git commit --amend")])]),t._v(" "),s("h2",{attrs:{id:"修改多次提交"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#修改多次提交","aria-hidden":"true"}},[t._v("#")]),t._v(" 修改多次提交")]),t._v(" "),s("p",[t._v("交互式rebase的功能在操作多次未提交commit时非常有用，以某次"),s("code",[t._v("<commit>")]),t._v("为基础，重写其后(不包含这次)所有的commit，可以进行非常多的操作。我经常使用的有"),s("code",[t._v("squash")]),t._v(", "),s("code",[t._v("reword")])]),t._v(" "),s("p",[s("code",[t._v("git rebase -i <commit>")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# p, pick <commit> = use commit 默认项(保留)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# r, reword <commit> = use commit, but edit the commit message (修改commit信息)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# e, edit <commit> = use commit, but stop for amending (修改此次提交)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# s, squash <commit> = use commit, but meld into previous commit (合并至前一次提交)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# f, fixup <commit> = like "squash", but discard this commit\'s log message')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# x, exec <command> = run command (the rest of the line) using shell")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# b, break = stop here (continue rebase later with 'git rebase --continue')")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# d, drop <commit> = remove commit")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# l, label <label> = label current HEAD with a name")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# t, reset <label> = reset HEAD to a label")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# m, merge [-C <commit> | -c <commit>] <label> [# <oneline>]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# .       create a merge commit using the original merge commit's")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# .       message (or the oneline, if no original merge commit was")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# .       specified). Use -c <commit> to reword the commit message.")]),t._v("\n")])])]),s("h2",{attrs:{id:"其他"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#其他","aria-hidden":"true"}},[t._v("#")]),t._v(" 其他")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("撤销文件改动"),s("br"),t._v(" "),s("code",[t._v("git checkout -- <file>...")])])]),t._v(" "),s("li",[s("p",[t._v("撤销暂存文件改动"),s("br"),t._v(" "),s("code",[t._v("git reset HEAD <file>...")])])]),t._v(" "),s("li",[s("p",[t._v("撤销上一次提交"),s("br"),t._v("\n比如提交已经提交到远程，不适合再使用reset来移动HEAD，此时可以使用revert，用一次新的commit来回滚之前的commit"),s("br"),t._v(" "),s("code",[t._v("git revert <commit>")])])]),t._v(" "),s("li",[s("p",[t._v("只add，没有commit后执行了危险操作"),s("br"),t._v(" "),s("a",{attrs:{href:"https://www.cnblogs.com/hope-markup/p/6683522.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("关于git reset --hard这个命令的惨痛教训"),s("OutboundLink")],1)])])]),t._v(" "),s("blockquote",[s("p",[t._v("参考"),s("br"),t._v(" "),s("a",{attrs:{href:"https://www.centos.bz/2018/01/%E4%BB%8E%E6%92%A4%E9%94%80-rebase-%E8%B0%88%E8%B0%88-git-%E5%8E%9F%E7%90%86/#%E5%88%A9%E7%94%A8%20reflog%20%E6%92%A4%E9%94%80%E5%8F%98%E5%9F%BA",target:"_blank",rel:"noopener noreferrer"}},[t._v("1. 从撤销 rebase 谈谈 git 原理"),s("OutboundLink")],1),s("br"),t._v(" "),s("a",{attrs:{href:"https://blog.csdn.net/sndamhming/article/details/53993502",target:"_blank",rel:"noopener noreferrer"}},[t._v("2. Git中HEAD和ORIG_HEAD指针指的是什么"),s("OutboundLink")],1),s("br"),t._v(" "),s("a",{attrs:{href:"https://git-scm.com/book/zh/v2",target:"_blank",rel:"noopener noreferrer"}},[t._v("3. Pro Git"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);e.default=r.exports}}]);